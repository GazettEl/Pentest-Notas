# 1.1.8 Supervisión de archivos y comandos

Es extremadamente valioso saber cómo monitorear archivos y comandos en tiempo real.&#x20;

## tail

El uso más común de **`tail`** es monitorear las entradas del archivo de registro a medida que se escriben. Por ejemplo, es posible que deseemos monitorear los registros de Apache para ver si las solicitudes echas desde una dirección IP:

```
$ tail -f /var/log/apache2/access.log | grep 192.168.100.23
192.168.100.23 - - [18/Oct/2021:02:50:19 +0000] "GET / HTTP/1.1" 200 3477 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36"
192.168.100.23 - - [18/Oct/2021:02:50:19 +0000] "GET /icons/ubuntu-logo.png HTTP/1.1" 200 3623 "http://192.168.100.106/" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36"
192.168.100.23 - - [18/Oct/2021:02:50:19 +0000] "GET /favicon.ico HTTP/1.1" 404 493 "http://192.168.100.106/" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36"
192.168.100.23 - - [18/Oct/2021:02:50:45 +0000] "GET / HTTP/1.1" 200 3477 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36"
```

La opción **`-f`** (follow) es muy útil, ya que actualiza continuamente la salida a medida que crece el archivo de destino.

Otro parámetro conveniente es -**nx**, que genera el último número "X" de líneas, en lugar del valor predeterminado de 10.

## watch

El comando **`watch`** se utiliza para ejecutar un comando designado a intervalos regulares. De forma predeterminada, se ejecuta cada dos segundos, pero podemos especificar un intervalo diferente utilizando la opción -n X para que se ejecute cada "X" número de segundos. Por ejemplo, este comando enumerará los usuarios que han iniciado sesión (a través del comando w) una vez cada 5 segundos:

```
$ watch -n 5 w
Every 5,0s: w                                                                                                                                                                                                                        grafana-server: Mon Oct 18 02:55:56 2021

 02:55:56 up 7 min,  1 user,  load average: 0,00, 0,03, 0,00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
guillerm pts/0    192.168.100.23   02:49    6.00s  0.14s  0.00s watch -n 5 w
```

Por ejemplo, si quisiéramos monitorear el uso del CPU y memoria para cada programa en un intervalo de 5 segundos, podemos hacer lo siguiente:&#x20;

```
watch -n 5 "ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%cpu"
```

Output:

![](<../../../.gitbook/assets/imagen (2) (1).png>)
